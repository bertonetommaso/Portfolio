<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>B.T. | Industrial Design Journal</title>
<style>
:root {
--bg-color: rgb(240, 240, 240);
--fg-color: rgb(40, 40, 40);
--vh: 100vh;
}

/* --- MOTORE LINGUE E TASTO BANDIERA --- */
body[data-lang="en"] .lang-it { display: none !important; }
body[data-lang="it"] .lang-en { display: none !important; }

#lang-btn {
    position: fixed; top: 30px; right: 30px; z-index: 10015;
    background: transparent; border: none;
    cursor: pointer; pointer-events: all;
    transition: transform 0.3s ease;
    display: flex; align-items: center; justify-content: center;
    padding: 5px;
}
/* Misura grande per PC */
#lang-btn svg {
    width: 32px; 
    height: 22px;
    border-radius: 2px;
    border: 1px solid rgba(150,150,150,0.3);
    display: block;
}
#lang-btn:hover { transform: scale(1.1); }

@media (max-width: 768px) {
    #lang-btn { top: 20px; right: 20px; }
    /* Misura originale piccola per Mobile */
    #lang-btn svg {
        width: 26px; 
        height: 18px;
    }
}

/* --- CORE SETUP --- */
* { margin: 0; padding: 0; box-sizing: border-box; cursor: none !important; -webkit-tap-highlight-color: transparent; }

html { 
    scroll-snap-type: y mandatory; 
    scroll-behavior: smooth; 
    touch-action: auto; 
    overscroll-behavior: none; 
    height: 100%;
}

body { 
background-color: var(--bg-color); 
color: var(--fg-color); 
font-family: 'Inter', sans-serif; 
overflow-x: hidden; 
transition: background-color 0.4s ease; 
user-select: none; 
width: 100%; 
min-height: 100vh;
}

/* CONFIGURAZIONE MOBILE - CONTAINER SCROLL */
@media (max-width: 768px) {
    html, body {
        height: 100% !important;
        width: 100% !important;
        margin: 0;
        padding: 0;
        overflow: hidden !important; 
        position: fixed !important;  
        overscroll-behavior: none;
    }

    #ghost-scroll {
        display: block !important;
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100dvh !important; 

        overflow-y: scroll !important; 
        scroll-snap-type: y mandatory !important; 
        scroll-behavior: smooth;
        -webkit-overflow-scrolling: touch !important; 
        overscroll-behavior-y: none !important;
        z-index: 50 !important; 
        pointer-events: all !important;
    }

    nav {
        pointer-events: auto !important;
        z-index: 10001 !important;
        display: flex !important;
        flex-direction: row !important;
        flex-wrap: nowrap !important; 
        width: 100% !important;
        overflow-x: auto !important; 
        overflow-y: hidden !important;
        white-space: nowrap !important;
        touch-action: pan-x !important; 
        -webkit-overflow-scrolling: touch !important; 
        padding-bottom: 30px; 
    }

    .nav-group {
        flex-shrink: 0 !important; 
    }

    .main-link, .sub-link {
        pointer-events: auto !important;
        display: inline-flex !important;
    }

    

    #mob-up, #mob-down { display: none !important; }
}

.snap-point { 
    height: 100vh;
    height: 100dvh; 
    scroll-snap-align: start; 
    scroll-snap-stop: always; 
    pointer-events: none; 
}

.mobile-nav-arrow {
    position: fixed; left: 20px; z-index: 10020; font-size: 2.5rem;
    color: var(--fg-color); opacity: 0.5; cursor: pointer; display: none;
    transition: opacity 0.3s, transform 0.2s; pointer-events: all; padding: 10px;
}
.mobile-nav-arrow:active { transform: scale(1.2); opacity: 1; }
#mob-up { top: 20px; }
#mob-down { bottom: 80px; } 
@media (max-width: 768px) { .mobile-nav-arrow { display: block; } }

#signature-btn {
    position: fixed; top: 30px; left: 50%; 
    z-index: 10005;
    font-weight: 900; font-size: 1.2rem; letter-spacing: 4px; text-transform: uppercase;
    pointer-events: all; white-space: nowrap; 
    transition: filter 0.4s ease, transform 0.3s ease, background-color 0.3s ease, color 0.3s ease;
    text-shadow: 0.5px 0px 0px currentColor;
    padding: 10px 24px; 
    border: 2px solid currentColor; 
    border-radius: 50px; 
    background-color: transparent; 
    animation: organic-float 8s ease-in-out infinite;
}

@keyframes organic-float {
    0%   { transform: translate(-50%, 0px) rotate(0deg); }
    33%  { transform: translate(-50%, -3px) rotate(0.8deg); } 
    66%  { transform: translate(-50%, 2px) rotate(-0.8deg); } 
    100% { transform: translate(-50%, 0px) rotate(0deg); }
}

#signature-btn:hover { 
    transform: translate(-50%, 0) scale(1.1); 
    background-color: var(--fg-color); 
    color: var(--bg-color); 
    animation-play-state: paused; 
}

#custom-cursor {
    position: fixed; width: 18px; height: 18px; background-color: white; border-radius: 50%;
    pointer-events: none; z-index: 10006; mix-blend-mode: difference;
    transition: width 0.3s ease, height 0.3s ease, transform 0.1s linear; 
    transform: translate3d(-50%, -50%, 0); left: 0; top: 0;
}
#custom-cursor.active { width: 22px; height: 22px; animation: wave 0.6s infinite ease-in-out; }
@media (pointer: coarse), (hover: none) { #custom-cursor { display: none !important; } }

@keyframes wave {
    0%, 100% { border-radius: 50%; transform: translate3d(-50%, -50%, 0) scale(1); }
    50% { border-radius: 35% 65% 50% 50%; transform: translate3d(-51%, -49%, 0) scale(1.05); }
}

.droplet {
    position: fixed; width: 8px; height: 8px; background-color: white; border-radius: 50%; 
    pointer-events: none; z-index: 10004; mix-blend-mode: difference; transform: translate3d(-50%, -50%, 0);
}

nav { position: fixed; z-index: 10000; opacity: 0; transition: opacity 0.8s ease; pointer-events: none; }
nav.visible { opacity: 1; pointer-events: all; }

@media (min-width: 769px) {
    nav { left: 20%; top: 50%; transform: translate(-50%, -50%); display: flex; flex-direction: column; gap: 15px; }
    .nav-group { display: flex; flex-direction: column; gap: 8px; }
    .sub-nav { max-height: 0; overflow: hidden; padding-left: 37px; display: flex; flex-direction: column; gap: 6px; transition: max-height 0.5s ease; }
    .nav-group.active .sub-nav { max-height: 150px; margin-top: 5px; }
}

@media (max-width: 768px) {
    nav { 
        bottom: 0; left: 0; width: 100%; display: flex; flex-direction: row; gap: 20px; 
        overflow-x: auto; padding: 20px 20px 30px 20px; justify-content: flex-start;
        background: transparent !important;
        -ms-overflow-style: none; scrollbar-width: none; 
    }
    nav::-webkit-scrollbar { display: none; }
    .nav-group { display: flex; flex-direction: column; flex-shrink: 0; transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
    .sub-nav { display: none; }
    .main-link { opacity: 0.4 !important; white-space: nowrap; font-size: 0.85rem !important; }
    .nav-group.active .main-link { opacity: 1 !important; transform: scale(1.1); font-weight: 900; }
    .nav-group.active .main-link::after { 
        content: ''; position: absolute; bottom: -8px; left: 0; width: 100%; height: 2px; 
        background: var(--fg-color); 
    }
    .main-link::before { display: none; } 
}

.main-link { 
    color: inherit !important; text-decoration: none; font-size: 0.85rem; font-weight: 900; 
    text-transform: uppercase; letter-spacing: 2px; opacity: 0.2; 
    display: flex; align-items: center; gap: 12px; transition: 0.4s; position: relative;
}

@media (min-width: 769px) {
    .main-link::before { content: ''; width: 12px; height: 2px; background: var(--fg-color); transition: 0.4s; }
    .main-link:hover { opacity: 0.7 !important; }
    
    .hint-horizontal { position: absolute; right: 5vw; top: 50%; transform: translateY(-50%); display: flex; align-items: center; gap: 20px; pointer-events: all; cursor: pointer; z-index: 1000 !important; }
    
    .hint-horizontal-left {
        position: absolute;
        left: 5vw;
        top: 50%;
        transform: translateY(-50%);
        display: flex;
        align-items: center;
        gap: 40px;
        pointer-events: all;
        cursor: pointer;
        z-index: 1000 !important;
    }
    
    .nav-group.active .main-link { opacity: 1 !important; transform: translateX(5px); }
    .nav-group.active .main-link::before { width: 25px; }
}

a { text-decoration: none !important; color: inherit; }

.sub-link { 
    color: var(--fg-color) !important; 
    text-decoration: none !important;  
    font-family: 'Inter', sans-serif !important; 
    font-size: 0.7rem !important; 
    text-transform: uppercase !important; 
    letter-spacing: 1px !important; 
    opacity: 0.4 !important; 
    transition: all 0.3s ease !important; 
    font-weight: 600 !important; 
    display: block !important;
}
.sub-link:hover { opacity: 0.9 !important; transform: translateX(4px) !important; }
.sub-link.active { opacity: 1 !important; font-weight: 900 !important; }

.char { display: inline-block; transition: transform 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
.char:hover { transform: translateY(-4px) rotate(2deg); color: inherit; }

h1.monumental { font-weight: 900; line-height: 0.9; text-transform: uppercase; letter-spacing: -3px; margin: 15px 0; width: 100%; display: flex; flex-direction: column; align-items: center; text-align: center; }
h1.monumental div { white-space: nowrap; }
@media (min-width: 769px) { h1.monumental { font-size: 7.5rem; letter-spacing: -5px; } }
@media (max-width: 768px) { h1.monumental { font-size: 10vw; letter-spacing: -1px; margin: 10px 0; width: 95vw; margin-left: auto; margin-right: auto; } }

em.italic-script { font-family: 'Georgia', serif; font-style: italic; display: block; }
@media (min-width: 769px) { em.italic-script { font-size: 2rem; } }
@media (max-width: 768px) { em.italic-script { font-size: 1.2rem; } }

.italic-script-small { font-family: 'Georgia', serif; font-style: italic; font-size: 1rem; }
@media (max-width: 768px) { .italic-script-small { font-size: 0.9rem; } }

.horizontal-slider { display: flex; width: 200vw; height: 100vh; transition: transform 0.8s cubic-bezier(0.23, 1, 0.32, 1); will-change: transform; }
.panel { width: 100vw; height: 100vh; display: flex; justify-content: center; align-items: center; flex-shrink: 0; position: relative; }

.centered-container { display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center; width: 100vw; height: 100vh; padding: 20px; }

.presentation-content { display: flex; align-items: center; justify-content: center; width: 100vw; height: 100%; padding: 0 10%; }
.presentation-rect { border: 2px solid var(--fg-color); flex-shrink: 0; position: relative; }
.presentation-text { text-align: left; }

@media (min-width: 769px) {
    .presentation-content { gap: 100px; }
    .presentation-rect { width: 380px; height: 520px; margin-left: 80px; }
    .presentation-text h2 { font-size: 4rem; margin-bottom: 25px; }
}
@media (max-width: 768px) {
    .presentation-content { flex-direction: column-reverse; gap: 20px; justify-content: center; text-align: center; margin-top: -15vh !important; }
    .presentation-rect { width: 40vw !important; height: 25vh !important; margin-top: 0 !important; }
    .presentation-text { text-align: center; max-width: 90%; }
    .presentation-text h2 { font-size: 2.5rem; margin-bottom: 10px; }
    .presentation-text p { font-size: 0.9rem; }
}

.hint-vertical { position: absolute; left: 50%; transform: translateX(-50%); display: flex; flex-direction: column; align-items: center; gap: 8px; pointer-events: all; cursor: pointer; z-index: 10010; }
@media (min-width: 769px) { .hint-vertical { bottom: 5vh; } }
@media (max-width: 768px) { .hint-vertical { bottom: 18vh; } }

.hint-horizontal { position: absolute; right: 5vw; top: 50%; transform: translateY(-50%); display: flex; align-items: center; gap: 20px; pointer-events: all; }
@media (max-width: 768px) {
    .hint-horizontal { top: 70%; flex-direction: row; gap: 8px; right: 5vw; }
    .hint-horizontal span:first-child { display: block; opacity: 0.8; } 
}
.arrow { font-size: 1.2rem; margin-left: 20px; }

.portfolio-content { position: absolute; z-index: 2; pointer-events: none; }
.image-container { position: absolute; background: #ddd; box-shadow: 0 40px 80px rgba(0,0,0,0.1); z-index: 1; will-change: transform; }
.image-container img { width: 100%; height: auto; display: block; }

@media (min-width: 769px) {
    .portfolio-content { left: 33vw; top: 50%; transform: translateY(-50%); max-width: 310px; text-align: left; }
    .image-container { right: 10vw; top: 50%; transform: translateY(-50%); width: 420px; height: auto; }
    .portfolio-content h3 { font-size: 0.9rem; margin-bottom: 1rem; opacity: 0.6; }
    .portfolio-content h2 { font-size: 5rem; margin-bottom: 1.5rem; line-height: 0.9}
}
@media (max-width: 768px) {
    .hint-horizontal-left { display: none !important; }
    .cube-face:has(.portfolio-content) {
        display: flex !important;
        flex-direction: column !important;
        justify-content: space-between !important; 
        align-items: center !important;
        padding-top: 15vh !important; 
        padding-bottom: 130px !important; 
        height: 100dvh !important;
        box-sizing: border-box !important;
    }

    .portfolio-content { 
        position: relative !important; 
        width: 90% !important; 
        text-align: center !important; 
        flex-shrink: 0; 
        margin-bottom: 20px; 
        pointer-events: none;
    }
    
    .image-container { 
        position: absolute !important;
        top: 65vh !important; 
        left: 50% !important; 
        transform: translate(-50%, -50%) !important; 
        width: 80vw !important;  
        height: auto !important; 
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
        background: transparent !important;
        box-shadow: none !important; 
    }

    .image-container img {
        width: auto !important;
        height: auto !important;
        max-width: 100% !important;
        max-height: 30vh !important; 
        object-fit: contain !important; 
        display: block !important;
        box-shadow: 0 20px 40px rgba(0,0,0,0.15) !important;
    }

    .portfolio-content h3 { font-size: 0.7rem; margin-bottom: 0.5rem; opacity: 0.6; font-weight: 500; }
    .portfolio-content h2 { font-size: 3rem; margin-bottom: 1rem; line-height: 1; }
    .portfolio-content p { font-size: 0.9rem; max-width: 100%; }
}

.scene { position: fixed; top: 0; left: 0; width: 100%; height: 100vh; perspective: 1500px; z-index: 5; pointer-events: none; }
.cube-wrapper { width: 100%; height: 100%; transform-style: preserve-3d; }
.scroll-container { position: relative; z-index: 10; pointer-events: none; }
.cube-face { width: 100%; height: 100vh; display: flex; position: absolute; top: 0; left: 0; backface-visibility: hidden; opacity: 0; will-change: transform, opacity; pointer-events: none; }
.cube-face.active-content { pointer-events: all; }

.final-links { display: flex; gap: 20px; margin-top: 40px; justify-content: center; align-items: center; flex-wrap: wrap; }
.box { 
    width: 110px; height: 110px; border: 2px solid var(--fg-color); 
    display: flex; align-items: center; justify-content: center; 
    transition: 0.4s ease-out; 
    font-size: 0.7rem; font-weight: 900; text-transform: uppercase; 
    letter-spacing: 1px; color: inherit; text-decoration: none; 
    overflow: hidden; white-space: nowrap; position: relative; 
}

.box:hover { transform: scale(1.05); background: white !important; color: black !important; border-color: white !important; box-shadow: 0 0 30px rgba(255, 255, 255, 0.8); z-index: 10; }
.box.copied { width: 300px !important; background: white !important; color: black !important; border-color: white !important; box-shadow: 0 0 30px rgba(255, 255, 255, 0.8); }

.mail-box { width: 110px; }
@media (min-width: 769px) { .mail-box:hover { width: 360px; } .mail-box:hover .mail-text { opacity: 0; } .mail-box:hover .mail-address { opacity: 1; } }

.mail-box .mail-address { position: absolute; opacity: 0; font-size: 0.65rem; transition: 0.4s; pointer-events: none; text-transform: lowercase; }
.mail-box.copied .mail-address { opacity: 1; }
.mail-box.copied .mail-text { opacity: 0; }

@media (max-width: 768px) {
    .final-links { gap: 10px; }
    .box { width: 90px; height: 90px; font-size: 0.6rem; }
    .sub-title { font-size: 3rem !important; }
}

@media (min-width: 769px) { .sub-title { font-size: 3.5rem !important; } }

.img-caption {
    position: absolute;
    bottom: -25px; 
    right: 0;       
    font-size: 0.65rem;
    text-transform: uppercase;
    letter-spacing: 1px;
    opacity: 0.5;
    white-space: nowrap; 
    color: var(--fg-color);
}   
@media (max-width: 768px) {
    nav { pointer-events: auto !important; z-index: 10001 !important; }
    .main-link, .sub-link { pointer-events: auto !important; }
    .img-caption {
        left: 50% !important;
        right: auto !important;
        transform: translateX(-50%) !important;
        text-align: center !important;
        white-space: normal !important;
        width: 100% !important;
        bottom: auto !important; 
        top: -30px !important;   
    }
    .final-links, .horizontal-slider { position: relative; z-index: 60 !important; pointer-events: auto !important; }
    .final-links { position: relative !important; z-index: 60 !important; pointer-events: auto !important; width: 100%; }
    .box, .mail-box { pointer-events: auto !important; position: relative !important; z-index: 61 !important; }
    .hint-vertical, .hint-horizontal { position: absolute !important; z-index: 60 !important; pointer-events: auto !important; } 
}   
</style>
</head>
<body data-lang="en">
<button id="lang-btn">
    <svg viewBox="0 0 60 30" width="26" height="18" style="border-radius:2px; border: 1px solid rgba(150,150,150,0.3); display: block;">
        <rect width="20" height="30" fill="#009246"/><rect x="20" width="20" height="30" fill="#fff"/><rect x="40" width="20" height="30" fill="#ce2b37"/>
    </svg>
</button>
<div id="signature-btn">HOME</div>
<div id="custom-cursor"></div>
<nav id="navbar"></nav>

<div id="mob-up" class="mobile-nav-arrow">↑</div>
<div id="mob-down" class="mobile-nav-arrow">↓</div>

<div class="scene"><div class="cube-wrapper" id="cube-container"></div></div>
<div class="scroll-container" id="ghost-scroll"></div>
<script>
const projects = [
{ 
title: "Viote", 
desc: "<span class='lang-en'>Viote it's a <b>polifunctional object</b>, serving both as an engaging <b>toy</b>, and as a <b>photo holder</b>.</span><span class='lang-it'>Viote è un <b>oggetto polifunzionale</b>, che funge sia da <b>giocattolo</b> coinvolgente, sia da <b>portafoto</b>.</span>", 
sub: [
{ title: "<span class='lang-en'>Concept</span><span class='lang-it'>Concept</span>", text: "<span class='lang-en'>Its seemingly complicated profile derives from the <b>hexasphericon</b>, a solid obtained by revolving an hexagon around its central axis. Half of it is then rotated bey 60°, finally obtaining <b>a solid built by a continuous surface</b>.</span><span class='lang-it'>Il suo profilo apparentemente complicato deriva dall'<b>esasfericone</b>, un solido ottenuto ruotando un esagono attorno al suo asse centrale. Metà di esso viene poi ruotata di 60°, ottenendo infine <b>un solido formato da una superficie continua</b>.</span>" },
{ title: "<span class='lang-en'>Texture</span><span class='lang-it'>Texture</span>", text: "<span class='lang-en'>Viote is entirely made of <b>maple wood</b>, choses for its low density, which makes it relatevely easy to <b>lathe</b> it. The two halves preserve the <b>original wooden texture</b>, to furthermore engage the user on a <b>tactile level</b>.</span><span class='lang-it'>Viote è interamente realizzato in <b>legno di acero</b>, scelto per la sua bassa densità, che lo rende relativamente facile da <b>tornire</b>. Le due metà conservano la <b>texture originale del legno</b>, per coinvolgere ulteriormente l'utente a <b>livello tattile</b>.</span>" },
{ title: "<span class='lang-en'>Process</span><span class='lang-it'>Processo</span>", text: "<span class='lang-en'>The result is a useful gadget, proud of its birthplace: <b>Val But</b>. Enjoyable by children, as <b>a toy</b>, and by adults, as it holds in place, thanks to its narrow slit, <b>a special postcard</b>.</span><span class='lang-it'>Il risultato è un gadget utile, orgoglioso del suo luogo di nascita: la <b>Val But</b>. Apprezzabile dai bambini come <b>giocattolo</b>, e dagli adulti come portafoto, grazie alla stretta fessura per <b>una cartolina speciale</b>.</span>" }
], 
img: "in-mano.jpg", 
subImages: ["geometria-viote.jpg", "su-pavimento2.jpg", "render-viote2.jpg"], 
color: [221, 194, 161] 
},
{ 
title: "Clīvio", 
desc: "<span class='lang-en'>The Clīvio chair is conceived with the meaningful ambition of bringing a fragment of the <b>natural world into everyday life</b>. The <b>cotton rope</b> and its <b>fastener</b> turn a functional element into a distinctive mark.</span><span class='lang-it'>La sedia Clīvio è concepita con l'ambizione di portare un frammento del <b>mondo naturale nella vita quotidiana</b>. La <b>corda di cotone</b> e il suo <b>sistema di fissaggio</b> trasformano un elemento funzionale in un segno distintivo.</span>",
caption: "<span class='lang-en'>Codesigned with Marocco Francesco.</span><span class='lang-it'>Progettato con Marocco Francesco.</span>", 
sub: [
{ title: "<span class='lang-en'>Concept</span><span class='lang-it'>Concept</span>", text: "<span class='lang-en'>Clīvio brings nature into living spaces through <b>fir wood</b>, a material that recalls the strength and continuity of the <b>KoCevsko forest</b>.</span><span class='lang-it'>Clīvio porta la natura negli spazi abitativi attraverso il <b>legno di abete</b>, un materiale che richiama la forza e la continuità della <b>foresta di Kočevsko</b>.</span>" },
{ title: "<span class='lang-en'>Detail</span><span class='lang-it'>Dettaglio</span>", text: "<span class='lang-en'>Its essential geometry allows it to be <b>stacked with ease</b> when disassembled, embodying a vision of <b>practical and sustainable design</b>. The orange <b>heat shrink tubing</b> gives the system a refined and contemporary accent, whereas the <b>rope stoppers</b> make the <b>assembly and disassembly easy</b>.</span><span class='lang-it'>La geometria essenziale permette di <b>impilarla con facilità</b> da smontata, incarnando un <b>design pratico e sostenibile</b>. Il <b>tubo termorestringente</b> arancione dà un accento contemporaneo, mentre i <b>fermacorda</b> rendono <b>l'assemblaggio intuitivo</b>.</span>" },
{ title: "<span class='lang-en'>Output</span><span class='lang-it'>Risultato</span>", text: "<span class='lang-en'>As a result, Clīvio's <b>essential lines</b> and the essence of the wood itself contribute to create <b>a serene space</b>, welcoming the user in the environment it belongs to.</span><span class='lang-it'>Di conseguenza, le <b>linee essenziali</b> di Clīvio e l'essenza del legno stesso contribuiscono a creare <b>uno spazio sereno</b>, accogliendo l'utente nel proprio ambiente.</span>" }
], 
img: "clivio-intera.png", 
subImages: ["foresta.jpg", "clivio-smontato2.jpg", "clivio-ambiente.jpeg"], 
color: [233, 187, 135] 
},
{   title: "Toori", 
desc: "<span class='lang-en'>A reflection on <b>simplicity and modularity</b>. Simple cylindrical forms are connected to one another, creating a <b>functional</b>, <b>customizable</b>, and <b>modular</b> object. Only two wooden elements, an elastic band, and two screws give <b>more than six ends</b>.</span><span class='lang-it'>Una riflessione su <b>semplicità e modularità</b>. Semplici forme cilindriche sono collegate creando un oggetto <b>funzionale</b>, <b>personalizzabile</b> e <b>modulare</b>. Solo due elementi in legno, un elastico e due viti offrono <b>più di sei terminazioni</b>.</span>",
caption: "<span class='lang-en'>Codesigned with Salomone Arianna.</span><span class='lang-it'>Progettato con Salomone Arianna.</span>",   
sub: [
{ title: "<span class='lang-en'>Concept</span><span class='lang-it'>Concept</span>", text: "<span class='lang-en'>This project delivers <b>a dynamic coat rack</b>, able to shift its geometries to satisfy the user's needs. <b>Easely assemblable</b>, it uses primitive geometries and accessible materials to deliver an <b>useful and accessible product</b>.</span><span class='lang-it'>Questo progetto offre <b>un appendiabiti dinamico</b>, capace di cambiare geometrie per le esigenze dell'utente. <b>Facilmente assemblabile</b>, usa geometrie primitive per un prodotto <b>utile e accessibile</b>.</span>" },
{ title: "<span class='lang-en'>Technology</span><span class='lang-it'>Tecnologia</span>", text: "<span class='lang-en'>Accessories and hangers can be hung on <b>the unthreaded section of the shank</b> between the wall and the wooden element. The <b>elastic band</b> differs from the rest of the geometries in both shape and material, offering the user a contemporary and pleasing contrast.</span><span class='lang-it'>Gli accessori si possono appendere sulla <b>sezione non filettata del perno</b>. L'<b>elastico</b> si differenzia dal resto delle geometrie per forma e materiale, offrendo un piacevole contrasto visivo.</span>" },
{ title: "<span class='lang-en'>Impact</span><span class='lang-it'>Impatto</span>", text: "<span class='lang-en'>Toori offers in its <b>semplicity and modularity</b> a contemporary approach on coat racks. Every part of it it's optimized for maximizing <b>space and confort</b>, offering the user a variety of ways to hang clothes and accessories.</span><span class='lang-it'>Toori offre nella sua <b>semplicità e modularità</b> un approccio contemporaneo agli appendiabiti. Ottimizzato per massimizzare <b>spazio e comfort</b>, offre svariati modi per appendere i capi.</span>" }
], 
img: "preview-toori.jpg", 
subImages: ["schema-toori.jpg", "toori-bianco-dietro.jpg", "scomposto-toori2.jpg"],
color: [245, 180, 109] },

{   title: "Where's the Bus?", 
desc: "<span class='lang-en'>This project features a <b>lenticular poster</b> at public transport stops. Moving from side to side, the user experience two <b>contrasting visions</b> of the city.</span><span class='lang-it'>Questo progetto presenta un <b>poster lenticolare</b> alle fermate dei mezzi pubblici. Spostandosi lateralmente, l'utente sperimenta due <b>visioni contrastanti</b> della città.</span>",
caption: "<span class='lang-en'>Codesigned with Fiammetta Dario, Ferrari Tommaso, Cerri Lorenzo.</span><span class='lang-it'>Progettato con Fiammetta Dario, Ferrari Tommaso, Cerri Lorenzo.</span>",   
sub: [
{ title: "<span class='lang-en'>Concept</span><span class='lang-it'>Concept</span>", text: "<span class='lang-en'><b>How can we improve road usage, reduce stress and increase productivity?</b> Our project aims to answer these questions, presenting public transport as a solid alternative to private mobility while <b>playing a fun and immediate game</b>!</span><span class='lang-it'><b>Come possiamo migliorare l'uso delle strade e ridurre lo stress?</b> Il progetto risponde presentando il trasporto pubblico come valida alternativa alla mobilità privata, offrendo <b>un gioco divertente e immediato</b>!</span>" },
{ title: "<span class='lang-en'>Technology</span><span class='lang-it'>Tecnologia</span>", text: "<span class='lang-en'><b>Lenticular printing</b> reveals different images as viewing angles change. We chose this dynamic medium to visually <b>transform chaotic traffic into seamless public transport</b>, effectively demonstrating the shift from stress to productivity <b>in a single glance</b>.</span><span class='lang-it'>La <b>stampa lenticolare</b> rivela immagini diverse al variare dell'angolo visivo. Usiamo questo mezzo per <b>trasformare visivamente il traffico caotico in trasporto fluido</b>, dimostrandolo <b>in un solo sguardo</b>.</span>" },
{ title: "<span class='lang-en'>Impact</span><span class='lang-it'>Impatto</span>", text: "<span class='lang-en'>The user, when passing by a bus stop or directely waiting for the bus to pass, is relieved by <b>a simple game</b>, playable by just looking at the poster and <b>moving side to side</b>.</span><span class='lang-it'>L'utente, in attesa dell'autobus o di passaggio, trova sollievo in <b>un semplice gioco</b>, a cui può partecipare guardando il poster e <b>spostandosi da un lato all'altro</b>.</span>" }
], 
img: "cornice-poster.jpg", 
subImages: ["bus-problema.jpg", "dettaglio.jpg", "utente-poster2.jpg"],
color: [244, 220, 0] }
];

const cursor = document.getElementById('custom-cursor');
const signature = document.getElementById('signature-btn');
const cube = document.getElementById('cube-container');
const ghost = document.getElementById('ghost-scroll');
const navbar = document.getElementById('navbar');
const mobUp = document.getElementById('mob-up');
const mobDown = document.getElementById('mob-down');

let vh = window.innerHeight;
let mouseX = 0, mouseY = 0, excitedInterval = null;
let startX = 0, startY = 0, isDragging = false, currentXOffset = 0;
let currentActiveGroup = null;

let targetScrollY = 0;
let currentScrollY = 0;
const isMobile = () => window.innerWidth <= 768;

let flatFaces = [{ type: 'landing', color: [240, 240, 240] }];

projects.forEach((proj, pIdx) => {
    flatFaces.push({ type: 'main', title: proj.title, desc: proj.desc, projectIdx: pIdx, img: proj.img, color: proj.color, caption: proj.caption });
    proj.sub.forEach((subItem, sIdx) => {
        let specificImg = proj.img; 
        if (proj.subImages && proj.subImages[sIdx]) specificImg = proj.subImages[sIdx];
        let sTitle = subItem.title ? subItem.title : subItem; 
        let sDesc = subItem.text ? subItem.text : "";         
        flatFaces.push({ type: 'sub', title: proj.title, subTitle: sTitle, desc: sDesc, projectIdx: pIdx, img: specificImg, subIdx: sIdx, color: proj.color });
    }); 
});

flatFaces.push({ type: 'final-call', title: "CHECK ME OUT HERE!", color: [10, 10, 10] });

projects.forEach((proj, i) => {
    const group = document.createElement('div');
    group.className = 'nav-group'; group.id = `group-${i}`;
    const mainIdx = 1 + (i * 4);
    const mLink = document.createElement('a');
    mLink.className = 'main-link'; mLink.href = "#"; mLink.innerHTML = `0${i+1} — ${proj.title}`;
    mLink.onclick = (e) => { e.preventDefault(); navigateTo(1 + i * 4); };

    const sNav = document.createElement('div');
    sNav.className = 'sub-nav';

    proj.sub.forEach((subItem, si) => {
        const sl = document.createElement('a');
        sl.className = 'sub-link'; sl.id = `sublink-${i}-${si}`; sl.href = "#"; 
        let label = subItem.title ? subItem.title : subItem;
        sl.innerHTML = label; sl.onclick = (e) => { e.preventDefault(); navigateTo(2 + i * 4 + si); };
        sNav.appendChild(sl);
    });
    group.appendChild(mLink); group.appendChild(sNav); navbar.appendChild(group);
});

const contactGroup = document.createElement('div');
contactGroup.className = 'nav-group';
contactGroup.id = 'group-contacts';
const cLink = document.createElement('a');
cLink.className = 'main-link'; cLink.href = "#"; 
cLink.innerHTML = "<span class='lang-en'>05 — CONTACTS</span><span class='lang-it'>05 — CONTATTI</span>";
const finalPageIdx = flatFaces.length - 1;
cLink.onclick = (e) => { e.preventDefault(); navigateTo(finalPageIdx); };
contactGroup.appendChild(cLink);
navbar.appendChild(contactGroup);

flatFaces.forEach((data, i) => {
    const snap = document.createElement('div'); snap.className = 'snap-point'; ghost.appendChild(snap);
    const face = document.createElement('div'); face.className = 'cube-face';

    if (data.type === 'landing') {
        face.innerHTML = `
        <div class="horizontal-slider" id="main-slider">
            <div class="panel">
                <div class="centered-container">
                    <em class="italic-script lang-en" style="margin-bottom: -5px;">ciao!</em>
                    <em class="italic-script lang-it" style="margin-bottom: -5px;">ciao!</em>
                    
                    <h1 class="split-title monumental lang-en" style="margin: 0;">
                        <div>HERE'S MY</div><div>INDUSTRIAL</div><div>DESIGN</div><div>JOURNAL.</div>
                    </h1>
                    <h1 class="split-title monumental lang-it" style="margin: 0;">
                        <div>IL MIO</div><div>DIARIO DI</div><div>INDUSTRIAL</div><div>DESIGN.</div>
                    </h1>
                    
                    <em class="italic-script lang-en" style="margin-top: -5px;">enjoy!</em>
                    <em class="italic-script lang-it" style="margin-top: -5px;">buona visione!</em>
                </div>
            
                <div class="hint-vertical" onclick="navigateTo(1)">
                    <span class="italic-script-small lang-en">some of what i've done</span>
                    <span class="italic-script-small lang-it">alcuni dei miei lavori</span>
                    <span class="arrow">↓</span>
                </div>

                <div class="hint-horizontal" onclick="openPresentation()">
                    <span class="italic-script-small lang-en">who am i?</span>
                    <span class="italic-script-small lang-it">chi sono?</span>
                    <span class="arrow">→</span>
                </div>
            </div>

            <div class="panel">
                <div class="hint-horizontal-left" onclick="backToTitle()">
                    <span class="arrow">←</span>
                    <span class="italic-script-small lang-en">back to title</span>
                    <span class="italic-script-small lang-it">torna al titolo</span>
                </div>
                
                <div class="presentation-content">
                    <img src="foto-meno.jpg" class="presentation-rect" style="object-fit: cover;">
                    <div class="presentation-text lang-en">
                        <h2>Hi there!</h2>
                        <p>I’m Tommaso - 21 year old , studying Product Design at Politecnico di Torino. Keen to upgrade my software and practical skills, I’ve always been open to innovations and challenges to better myself. Through my projects I aim to convey functionality and a balanced aestethics.</p>
                    </div>
                    <div class="presentation-text lang-it">
                        <h2>Ciao!</h2>
                        <p>Sono Tommaso, ho 21 anni e studio Product Design al Politecnico di Torino. Desideroso di migliorare le mie competenze software e pratiche, sono sempre stato aperto all'innovazione e alle sfide per migliorarmi. Attraverso i miei progetti punto a trasmettere funzionalità e un'estetica bilanciata.</p>
                    </div>
                </div>

                <div class="hint-vertical" onclick="navigateTo(1)">
                    <span class="italic-script-small lang-en">some of what i've done</span>
                    <span class="italic-script-small lang-it">alcuni dei miei lavori</span>
                    <span class="arrow">↓</span>
                </div>
            </div>
        </div>`;    
    } else if (data.type === 'main') {
        const captionHTML = data.caption ? `<div class="img-caption">${data.caption}</div>` : '';
        face.innerHTML = `<div class="portfolio-content">
            <h3 class="lang-en">Project Overview</h3><h3 class="lang-it">Panoramica Progetto</h3>
            <h2>${data.title}</h2><p>${data.desc}</p></div>
            <div class="image-container"><img src="${data.img}">${captionHTML}</div>`;
    } else if (data.type === 'sub') {
        face.innerHTML = `<div class="portfolio-content">
            <h3>${data.title} / <span class="lang-en">Study</span><span class="lang-it">Studio</span></h3>
            <h2 class="sub-title">${data.subTitle}</h2><p>${data.desc || ""}</p> </div>
            <div class="image-container"><img src="${data.img}"></div>`;
    } else if (data.type === 'final-call') {
        face.innerHTML = `
            <div class="centered-container">
                <em class="italic-script lang-en">did something intrigue you?</em>
                <em class="italic-script lang-it">qualcosa ti ha incuriosito?</em>
                
                <h1 class="split-title monumental lang-en"><div>CHECK ME OUT</div><div>HERE!</div></h1>
                <h1 class="split-title monumental lang-it"><div>DAI UN'OCCHIATA</div><div>QUI!</div></h1>
                
                <div class="final-links">
                    <a href="https://www.instagram.com/bertone_des/" target="_blank" class="box">Instagram</a>
                    <a href="https://www.linkedin.com/in/tommaso-bertone-465542286" target="_blank" class="box">LinkedIn</a>
                    <div class="box mail-box"><span class="mail-text">Mail</span><span class="mail-address">bertonetommaso2@gmail.com</span></div>
                </div>
            </div>`;
    }
    cube.appendChild(face);
});

document.querySelectorAll('.split-title div').forEach(div => {
    const text = div.innerText; div.innerHTML = '';
    text.split('').forEach(c => {
        const s = document.createElement('span'); s.className = 'char';
        s.innerHTML = c === ' ' ? '&nbsp;' : c; div.appendChild(s);
    });
});

function navigateTo(index) {
    const target = index * window.innerHeight;
    if (isMobile()) {
        const scroller = document.getElementById('ghost-scroll');
        if (scroller) {
            scroller.scrollTo({ top: target, behavior: 'smooth' });
        }
    } else {
        window.scrollTo({ top: target, behavior: 'smooth' });
    }
}

mobUp.onclick = () => {
    let currentIdx = Math.round(window.scrollY / window.innerHeight);
    if (currentIdx > 0) navigateTo(currentIdx - 1);
};
mobDown.onclick = () => {
    let currentIdx = Math.round(window.scrollY / window.innerHeight);
    if (currentIdx < flatFaces.length - 1) navigateTo(currentIdx + 1);
};

const slider = document.getElementById('main-slider');
let isVerticalScroll = false; 

document.addEventListener('touchstart', (e) => {
    if (currentScrollY < vh * 0.5) { 
        isDragging = false; 
        isVerticalScroll = false; 
        startX = e.touches[0].clientX; 
        startY = e.touches[0].clientY; 
        if(slider) slider.style.transition = 'none'; 
    }
}, { passive: true });

document.addEventListener('touchmove', (e) => {
    if (e.target.closest('nav') || e.target.closest('.sub-nav') || e.target.closest('.nav-group')) return; 
    if (!isMobile() && !isDragging) e.preventDefault();
    
    if (isMobile() && currentScrollY < vh * 0.5) {
        const touch = e.touches[0];
        const diffX = touch.clientX - startX;
        const diffY = touch.clientY - startY;

        if (isVerticalScroll) return;
        if (!isDragging && Math.abs(diffY) > Math.abs(diffX) && Math.abs(diffY) > 5) {
            isVerticalScroll = true;
            return; 
        }
        if (Math.abs(diffX) > (Math.abs(diffY) * 2) && Math.abs(diffX) > 15) {
            isDragging = true;
            e.preventDefault(); 
            if(slider) slider.style.transform = `translate3d(${Math.max(-window.innerWidth, Math.min(0, currentXOffset + diffX))}px, 0, 0)`;
        }
    }
    if (isMobile() && !isDragging) spawnDroplets(e.touches[0].clientX, e.touches[0].clientY);
}, { passive: false });

document.addEventListener('touchend', (e) => {
    if (isDragging) { 
        isDragging = false; 
        finishSlide(e.changedTouches[0].clientX); 
    }
});

document.addEventListener('mousedown', (e) => { 
    if (e.target.closest('.hint-horizontal, .hint-horizontal-left, a, .box, #signature-btn, #lang-btn')) return;
    if (window.scrollY < vh * 0.5) { isDragging = true; startX = e.clientX; if(slider) slider.style.transition = 'none'; } 
});
document.addEventListener('mousemove', (e) => {
    mouseX = e.clientX; mouseY = e.clientY;
    cursor.style.left = mouseX + 'px'; cursor.style.top = mouseY + 'px';
    if (isDragging && slider) { const deltaX = e.clientX - startX; slider.style.transform = `translate3d(${Math.max(-window.innerWidth, Math.min(0, currentXOffset + deltaX))}px, 0, 0)`; }
});
document.addEventListener('mouseup', (e) => {
    if (!isDragging) return; isDragging = false; finishSlide(e.clientX);
});

function finishSlide(endX) {
    if(!slider) return;
    slider.style.transition = 'transform 0.6s cubic-bezier(0.23, 1, 0.32, 1)';
    if (Math.abs(endX - startX) > 100) {
        currentXOffset = (endX - startX < 0) ? -window.innerWidth : 0;
    } else {
        currentXOffset = currentXOffset === 0 ? 0 : -window.innerWidth;
    }
    slider.style.transform = `translate3d(${currentXOffset}px, 0, 0)`;
}

signature.onclick = () => { 
    navigateTo(0); 
    currentXOffset = 0; 
    if (slider) {
        slider.style.transition = 'transform 0.8s cubic-bezier(0.23, 1, 0.32, 1)'; 
        slider.style.transform = `translate3d(${currentXOffset}px, 0, 0)`; 
    }
};

document.addEventListener('mouseover', (e) => {
    if (e.target.closest('a, #signature-btn, #lang-btn, .char, .box, .presentation-rect, .mobile-nav-arrow, .monumental')) cursor.classList.add('active');
});
document.addEventListener('mouseout', (e) => cursor.classList.remove('active'));

document.addEventListener('mousedown', (e) => {
    const isClickable = e.target.closest('a, #signature-btn, #lang-btn, .box, .mail-box, .final-links, .mobile-nav-arrow, .monumental, .hint-vertical');
    const isLastPage = (currentScrollY / vh) > (flatFaces.length - 1.5);
    if (isClickable || isLastPage) spawnDroplets(e.clientX, e.clientY);
});

function spawnDroplets(x, y) {
    const count = isMobile() ? 1 : 4; 
    for (let i = 0; i < count; i++) {
        const d = document.createElement('div'); d.className = 'droplet'; document.body.appendChild(d);
        d.style.left = x + 'px'; d.style.top = y + 'px';
        const angle = Math.random() * Math.PI * 2; const dist = isMobile() ? 15 : 30;
        d.animate([{ opacity: 1 }, { transform: `translate(${Math.cos(angle)*dist}px, ${Math.sin(angle)*dist}px) scale(0)`, opacity: 0 }], { duration: 500 }).onfinish = () => d.remove();
    }
}

function lerp(c1, c2, f) { return c1.map((v, i) => Math.round(v + (c2[i] - v) * f)); }

navbar.addEventListener('touchmove', (e) => { e.stopPropagation(); }, { passive: true });
navbar.addEventListener('touchstart', (e) => { e.stopPropagation(); }, { passive: true });

function update() {
    if (isMobile()) {
        const scroller = document.getElementById('ghost-scroll');
        currentScrollY = scroller.scrollTop;
    } else {
        currentScrollY = window.scrollY;
    }

    const sY = currentScrollY;
    const progress = sY / vh;
    const idx = Math.floor(progress);
    const f = progress - idx;

    if (idx < flatFaces.length) {
        let rgb;
        if (idx < flatFaces.length - 1) {
            rgb = lerp(flatFaces[idx].color, flatFaces[idx + 1].color, f);
        } else {
            rgb = flatFaces[flatFaces.length - 1].color;
        }
        const bright = (rgb[0]*299 + rgb[1]*587 + rgb[2]*114)/1000;
        
        document.body.style.backgroundColor = `rgb(${rgb.join(',')})`;
        const textColor = bright > 130 ? 'rgb(40,40,40)' : 'rgb(245,245,245)';
        document.body.style.color = textColor;
        signature.style.filter = 'none'; 
        
        const langBtn = document.getElementById('lang-btn');
        if (langBtn) langBtn.style.color = textColor;
    }

    const isAtEnd = sY > (flatFaces.length - 1.2) * vh; 
    const isPCLanding = sY > vh * 0.4;
    if (isPCLanding && (!isAtEnd || isMobile())) {
        navbar.classList.add('visible');
    } else {
        navbar.classList.remove('visible');
    }

    const fcs = document.querySelectorAll('.cube-face');
    fcs.forEach((face, i) => {
        const dist = sY - (i * vh); 
        const off = dist / vh; 

        if (Math.abs(off) < 1.5) {
            face.style.display = 'flex';

            if (isMobile()) {
                face.style.transform = `translate3d(0, 0, 0)`; 
                let opacity = 1 - Math.abs(off);
                face.style.opacity = Math.max(0, Math.pow(opacity, 1.5)); 
                face.style.zIndex = 100 - Math.round(Math.abs(off) * 100); 
            } else {
                face.style.transform = `translate3d(0, ${-dist}px, ${Math.abs(off)*-1200}px) rotateX(${off*90}deg)`;
                face.style.opacity = Math.max(0, 1 - Math.pow(Math.abs(off), 2.2));
                face.style.zIndex = 'auto';
            }

            if (Math.abs(off) < 0.5) {
                face.classList.add('active-content'); const d = flatFaces[i];

                if (d.type === 'final-call' && window.matchMedia("(pointer: fine)").matches) {
                    cursor.classList.add('active');
                    if (!excitedInterval) excitedInterval = setInterval(() => spawnDroplets(mouseX, mouseY), 150);
                } else { if (excitedInterval) { clearInterval(excitedInterval); excitedInterval = null; } }

                document.querySelectorAll('.nav-group').forEach(g => g.classList.remove('active'));
                document.querySelectorAll('.sub-link').forEach(l => l.classList.remove('active'));

                let activeId = null;
                if (d.type === 'final-call') activeId = 'group-contacts';
                else if (d.projectIdx !== undefined) activeId = `group-${d.projectIdx}`;

                if (activeId) {
                    const grp = document.getElementById(activeId);
                    if (grp) {
                        grp.classList.add('active');
                        if (d.type === 'sub') {
                            const sl = document.getElementById(`sublink-${d.projectIdx}-${d.subIdx}`);
                            if (sl) sl.classList.add('active');
                        }
                        if (isMobile() && currentActiveGroup !== activeId) {
                            currentActiveGroup = activeId; 
                            const nav = document.getElementById('navbar');
                            const navWidth = nav.offsetWidth;
                            const elLeft = grp.offsetLeft;
                            const elWidth = grp.offsetWidth;
                            const scrollPos = elLeft - (navWidth / 2) + (elWidth / 2);
                            nav.scrollTo({ left: scrollPos, behavior: 'smooth' });
                        }
                    }
                }
            } else { face.classList.remove('active-content'); }
        } else { face.style.display = 'none'; face.style.opacity = 0; }
    });
    requestAnimationFrame(update);
}
update(); 
window.addEventListener('resize', () => { vh = window.innerHeight; if(!isMobile()) targetScrollY = window.scrollY; });

window.openPresentation = function() {
    navigateTo(0);
    currentXOffset = -window.innerWidth;
    if(slider) {
        slider.style.transition = 'transform 0.8s cubic-bezier(0.23, 1, 0.32, 1)';
        slider.style.transform = `translate3d(${currentXOffset}px, 0, 0)`;
    }
};

window.backToTitle = function() {
    navigateTo(0);
    currentXOffset = 0;
    if(slider) {
        slider.style.transition = 'transform 0.8s cubic-bezier(0.23, 1, 0.32, 1)';
        slider.style.transform = `translate3d(${currentXOffset}px, 0, 0)`;
    }
};

const ghostLayer = document.getElementById('ghost-scroll');
if (ghostLayer) {
    ghostLayer.addEventListener('click', (e) => {
        if (isMobile()) return; 
        
        ghostLayer.style.pointerEvents = 'none'; 
        const elementBelow = document.elementFromPoint(e.clientX, e.clientY);
        ghostLayer.style.pointerEvents = 'all';  

        if (elementBelow) {
            const clickable = elementBelow.closest('.hint-vertical, .hint-horizontal, .hint-horizontal-left, .box, a, #signature-btn, #lang-btn');
            if (clickable) {
                if (clickable.classList.contains('mail-box')) {
                    navigator.clipboard.writeText('bertonetommaso2@gmail.com');
                    showCopyEffect(clickable);
                    spawnDroplets(e.clientX, e.clientY);
                }
                else if (clickable.id === 'lang-btn') {
                    clickable.click();
                }
                else if (clickable.onclick) clickable.onclick(e);
                else if (clickable.href && !clickable.href.includes('#')) window.open(clickable.href, '_blank');
                else clickable.click();
            }
        }
    });

    let startTx = 0, startTy = 0;
    
    ghostLayer.addEventListener('touchstart', (e) => {
        startTx = e.touches[0].clientX;
        startTy = e.touches[0].clientY;
    }, { passive: true });

    ghostLayer.addEventListener('touchend', (e) => {
        if (!isMobile()) return;
        
        const endTx = e.changedTouches[0].clientX;
        const endTy = e.changedTouches[0].clientY;
        
        const distX = startTx - endTx; 
        const distY = startTy - endTy; 
        
        const absX = Math.abs(distX);
        const absY = Math.abs(distY);

        if (absX < 15 && absY < 15) {
            const clickables = document.querySelectorAll('.box, .hint-vertical, .hint-horizontal, .hint-horizontal-left, #lang-btn');
            let targetHit = false;

            clickables.forEach(el => {
                if (targetHit) return;
                const rect = el.getBoundingClientRect();
                if (endTx >= rect.left && endTx <= rect.right && endTy >= rect.top && endTy <= rect.bottom) {
                    targetHit = true;
                    if (el.classList.contains('mail-box')) {
                        const tempInput = document.createElement('input');
                        tempInput.value = 'bertonetommaso2@gmail.com';
                        document.body.appendChild(tempInput);
                        tempInput.select();
                        tempInput.setSelectionRange(0, 99999); 
                        document.execCommand('copy');
                        document.body.removeChild(tempInput);
                        showCopyEffect(el);
                    }
                    else if (el.id === 'lang-btn') {
                        el.click();
                    }
                    else if (el.tagName.toUpperCase() === 'A' && el.href) {
                        window.location.href = el.href; 
                    }
                    else {
                        el.click();
                    }
                }
            });
            spawnDroplets(endTx, endTy);
        }
        else if (absX > absY && absX > 40) {
            const scroller = document.getElementById('ghost-scroll');
            const h = window.innerHeight;
            const currentPage = Math.round(scroller.scrollTop / h);

            if (currentPage > 0) {
                let targetPage = currentPage;
                if (distX > 0) targetPage++; 
                else targetPage--; 

                if (targetPage >= 0 && targetPage < flatFaces.length) {
                    scroller.scrollTo({ top: targetPage * h, behavior: 'smooth' });
                }
            }
        }
    });
}

// --- INTERRUTTORE LINGUE CON ICONE FLAT SVG ---
const langBtn = document.getElementById('lang-btn');

// Disegno matematico delle due bandiere minimali
const iconIT = `<svg viewBox="0 0 60 30" width="26" height="18" style="border-radius:2px; border: 1px solid rgba(150,150,150,0.3); display: block;"><rect width="20" height="30" fill="#009246"/><rect x="20" width="20" height="30" fill="#fff"/><rect x="40" width="20" height="30" fill="#ce2b37"/></svg>`;
const iconEN = `<svg viewBox="0 0 60 30" width="26" height="18" style="border-radius:2px; border: 1px solid rgba(150,150,150,0.3); display: block;"><rect width="60" height="30" fill="#012169"/><path d="M0,0L60,30 M60,0L0,30" stroke="#fff" stroke-width="6"/><path d="M0,0L60,30 M60,0L0,30" stroke="#C8102E" stroke-width="3"/><path d="M30,0V30 M0,15H60" stroke="#fff" stroke-width="10"/><path d="M30,0V30 M0,15H60" stroke="#C8102E" stroke-width="6"/></svg>`;

if(langBtn) {
    langBtn.addEventListener('click', () => {
        const body = document.body;
        if (body.dataset.lang === 'en') {
            body.dataset.lang = 'it';
            langBtn.innerHTML = iconEN; // Mostra il disegno della bandiera inglese
        } else {
            body.dataset.lang = 'en';
            langBtn.innerHTML = iconIT; // Mostra il disegno della bandiera italiana
        }
    });
}    

function showCopyEffect(el) {
    const addr = el.querySelector('.mail-address');
    if(addr) addr.innerText = 'copied to clipboard!';
    el.classList.add('copied');
    setTimeout(() => { 
        if(addr) addr.innerText = 'bertonetommaso2@gmail.com'; 
        el.classList.remove('copied');
    }, 2000);
}
</script>
</body>


</html>


